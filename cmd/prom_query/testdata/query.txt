
# Scraper collection missing rsyncd inventory.
clear
load 1m
    up{service="scraper", machine="a", experiment="foo"} 1

eval instant at 0m count(up{service="scraper"})
    {} 1

# 
eval instant at 0m up{service="scraper"} UNLESS ON(machine, experiment) up{service="rsyncd"}
    up{service="scraper", machine="a", experiment="foo"} 1

# Sidestream
# The set of monitored sidestream exporters that are not on inventory machines (strict match):
clear
load 1m
    up{service="sidestream", machine="a", experiment="foo"} 1
    up{service="ssh806", machine="b"} 1

eval instant at 0m up{service="sidestream"} UNLESS ON(machine) up{service="ssh806"}
    up{service="sidestream", machine="a", experiment="foo"} 1

clear
load 1m
    up{service="sidestream", machine="a", experiment="foo"} 1
    up{service="ssh806", machine="a"} 1

eval instant at 0m up{service="sidestream"} UNLESS ON(machine) up{service="ssh806"}
# EMPTY RESULT.

# Scraper
# The set of monitored scraper targets that are not on inventory machines (strict match):

clear
load 1m
    up{service="scraper", machine="a"} 1
    up{service="ssh806", machine="a"} 1

eval instant at 0m up{service="scraper"} UNLESS ON(machine) up{service="ssh806"}
# EMPTY RESULT.

clear
load 1m
    up{service="scraper", machine="a"} 1
    up{service="ssh806", machine="b"} 1

eval instant at 0m up{service="scraper"} UNLESS ON(machine) up{service="ssh806"}
    up{service="scraper", machine="a"} 1
